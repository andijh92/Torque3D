<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DataChunker Class Reference</title>
<link href="torquedoc.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<table width="100%" class="header">
<tr>
<td style="background-image: url( 'images/t3d-documentation-header.png' ); height: 100px;">
   <!-- hack... makes the HTML Help compiler include the image into the project -->
   <img src="images/t3d-documentation-header.png" style="width: 0; height: 0; borders: 0;">
</td>
</tr>
<tr><td class="headermenu">
	<center>
	<a class="qindex" href="index.html">Main</a> &nbsp; 
	<a class="qindex" href="modules.html">Modules</a> &nbsp; 
	<a class="qindex" href="annotated.html">Class List</a> &nbsp; 
	<a class="qindex" href="namespaces.html">Namespace List</a>	&nbsp; 
	<a class="qindex" target="_blank" href="http://www.garagegames.com/documentation/torque-3d">Online</a>
	</center>
</td></tr>
</table>
<br>
<!-- END HEADER --><!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classDataChunker-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DataChunker Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements a chunked data allocator.  
 <a href="classDataChunker.html#details">More...</a></p>

<p><code>#include &lt;core/dataChunker.h&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for DataChunker:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classDataChunker__inherit__graph.png" border="0" usemap="#DataChunker_inherit__map" alt="Inheritance graph"/></div>
<map name="DataChunker_inherit__map" id="DataChunker_inherit__map">
<area shape="rect" id="node2" href="classChunker.html" title="Chunker\&lt; T \&gt;" alt="" coords="165,94,267,121"/>
<area shape="rect" id="node3" href="classChunker.html" title="Chunker\&lt; ShadowVolumeBSP\l::SVNode \&gt;" alt="" coords="529,9,722,51"/>
<area shape="rect" id="node4" href="classChunker.html" title="Chunker\&lt; ShadowVolumeBSP\l::SVPoly \&gt;" alt="" coords="529,116,722,157"/>
<area shape="rect" id="node5" href="classClassChunker.html" title="Templatized data chunker class with proper construction and destruction of its elements. " alt="" coords="149,270,283,297"/>
<area shape="rect" id="node6" href="classClassChunker.html" title="ClassChunker\&lt; Node \&gt;" alt="" coords="548,203,703,230"/>
<area shape="rect" id="node7" href="classClassChunker.html" title="ClassChunker\&lt; SceneObject\l::ZoneRef \&gt;" alt="" coords="533,387,717,428"/>
<area shape="rect" id="node8" href="classClassChunker.html" title="ClassChunker\&lt; SceneZoneSpace\l::ZoneSpaceRef \&gt;" alt="" coords="520,305,731,347"/>
<area shape="rect" id="node9" href="classMultiTypedChunker.html" title="This class is similar to the Chunker&lt;&gt; class above. " alt="" coords="151,462,281,489"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDataChunker_1_1DataBlock.html">DataBlock</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Block of allocated memory.  <a href="structDataChunker_1_1DataBlock.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ac61bd3b7845aeca3141777d3912e4065"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="classDataChunker.html#ac61bd3b7845aeca3141777d3912e4065a26c20bd412b8c1d0b7dfcb8b908793fe">PaddDBSize</a> = (sizeof(DataBlock) + 3) &amp; ~3, 
<br />
&#160;&#160;<a class="el" href="classDataChunker.html#ac61bd3b7845aeca3141777d3912e4065a536630bb06ed00f89cfb97eadca9c7c4">ChunkSize</a> = 16384 - PaddDBSize
<br />
 }</td></tr>
<tr class="separator:ac61bd3b7845aeca3141777d3912e4065"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afd20e1ef0ccc6b0727fd5a3f2f4e56f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataChunker.html#afd20e1ef0ccc6b0727fd5a3f2f4e56f8">DataChunker</a> (S32 size=<a class="el" href="classDataChunker.html#ac61bd3b7845aeca3141777d3912e4065a536630bb06ed00f89cfb97eadca9c7c4">ChunkSize</a>)</td></tr>
<tr class="memdesc:afd20e1ef0ccc6b0727fd5a3f2f4e56f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize using blocks of a given size.  <a href="#afd20e1ef0ccc6b0727fd5a3f2f4e56f8">More...</a><br /></td></tr>
<tr class="separator:afd20e1ef0ccc6b0727fd5a3f2f4e56f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe967e0513f83e1f5779590718d12293"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataChunker.html#abe967e0513f83e1f5779590718d12293">~DataChunker</a> ()</td></tr>
<tr class="separator:abe967e0513f83e1f5779590718d12293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2b4ea6cb055783bf929a8c3d045b6a4"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataChunker.html#aa2b4ea6cb055783bf929a8c3d045b6a4">alloc</a> (S32 size)</td></tr>
<tr class="memdesc:aa2b4ea6cb055783bf929a8c3d045b6a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to a chunk of memory from a pre-allocated block.  <a href="#aa2b4ea6cb055783bf929a8c3d045b6a4">More...</a><br /></td></tr>
<tr class="separator:aa2b4ea6cb055783bf929a8c3d045b6a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a792cbcb3afef543e4cb0dfc7ac4a610f"><td class="memItemLeft" align="right" valign="top">U32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataChunker.html#a792cbcb3afef543e4cb0dfc7ac4a610f">countUsedBlocks</a> ()</td></tr>
<tr class="separator:a792cbcb3afef543e4cb0dfc7ac4a610f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfd50a031e61d52e3977f1d2df308dea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataChunker.html#abfd50a031e61d52e3977f1d2df308dea">freeBlocks</a> (bool keepOne=false)</td></tr>
<tr class="memdesc:abfd50a031e61d52e3977f1d2df308dea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free all allocated memory blocks.  <a href="#abfd50a031e61d52e3977f1d2df308dea">More...</a><br /></td></tr>
<tr class="separator:abfd50a031e61d52e3977f1d2df308dea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a931c15416e49f2c1a86370ff4e24eea4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataChunker.html#a931c15416e49f2c1a86370ff4e24eea4">setChunkSize</a> (U32 size)</td></tr>
<tr class="separator:a931c15416e49f2c1a86370ff4e24eea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1278ca7f4f2be89abf94c371aa706612"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataChunker.html#a1278ca7f4f2be89abf94c371aa706612">swap</a> (<a class="el" href="classDataChunker.html">DataChunker</a> &amp;d)</td></tr>
<tr class="memdesc:a1278ca7f4f2be89abf94c371aa706612"><td class="mdescLeft">&#160;</td><td class="mdescRight">Swaps the memory allocated in one data chunker for another.  <a href="#a1278ca7f4f2be89abf94c371aa706612">More...</a><br /></td></tr>
<tr class="separator:a1278ca7f4f2be89abf94c371aa706612"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a8575b4b1460b1272f3a9d7bdcb1d9bce"><td class="memItemLeft" align="right" valign="top">S32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataChunker.html#a8575b4b1460b1272f3a9d7bdcb1d9bce">mChunkSize</a></td></tr>
<tr class="memdesc:a8575b4b1460b1272f3a9d7bdcb1d9bce"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size allocated for each page in the <a class="el" href="classDataChunker.html" title="Implements a chunked data allocator. ">DataChunker</a>.  <a href="#a8575b4b1460b1272f3a9d7bdcb1d9bce">More...</a><br /></td></tr>
<tr class="separator:a8575b4b1460b1272f3a9d7bdcb1d9bce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93dcfa2653fef3dbbc3ba1c1ae8a46a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDataChunker_1_1DataBlock.html">DataBlock</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDataChunker.html#a93dcfa2653fef3dbbc3ba1c1ae8a46a9">mCurBlock</a></td></tr>
<tr class="memdesc:a93dcfa2653fef3dbbc3ba1c1ae8a46a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">current page we're allocating data from.  <a href="#a93dcfa2653fef3dbbc3ba1c1ae8a46a9">More...</a><br /></td></tr>
<tr class="separator:a93dcfa2653fef3dbbc3ba1c1ae8a46a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements a chunked data allocator. </p>
<p>Calling new/malloc all the time is a time consuming operation. Therefore, we provide the <a class="el" href="classDataChunker.html" title="Implements a chunked data allocator. ">DataChunker</a>, which allocates memory in blocks of chunkSize (by default 16k, see ChunkSize, though it can be set in the constructor), then doles it out as requested, in chunks of up to chunkSize in size.</p>
<p>It will assert if you try to get more than ChunkSize bytes at a time, and it deals with the logic of allocating new blocks and giving out word-aligned chunks.</p>
<p>Note that new/free/realloc WILL NOT WORK on memory gotten from the <a class="el" href="classDataChunker.html" title="Implements a chunked data allocator. ">DataChunker</a>. This also only grows (you can call freeBlocks to deallocate and reset things). </p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="ac61bd3b7845aeca3141777d3912e4065"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ac61bd3b7845aeca3141777d3912e4065a26c20bd412b8c1d0b7dfcb8b908793fe"></a>PaddDBSize&#160;</td><td class="fielddoc">
<p>Padded size of <a class="el" href="structDataChunker_1_1DataBlock.html" title="Block of allocated memory. ">DataBlock</a>. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ac61bd3b7845aeca3141777d3912e4065a536630bb06ed00f89cfb97eadca9c7c4"></a>ChunkSize&#160;</td><td class="fielddoc">
<p>Default size of each <a class="el" href="structDataChunker_1_1DataBlock.html" title="Block of allocated memory. ">DataBlock</a> page in the <a class="el" href="classDataChunker.html" title="Implements a chunked data allocator. ">DataChunker</a>. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="afd20e1ef0ccc6b0727fd5a3f2f4e56f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DataChunker::DataChunker </td>
          <td>(</td>
          <td class="paramtype">S32&#160;</td>
          <td class="paramname"><em>size</em> = <code><a class="el" href="classDataChunker.html#ac61bd3b7845aeca3141777d3912e4065a536630bb06ed00f89cfb97eadca9c7c4">ChunkSize</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize using blocks of a given size. </p>
<p>One new block is allocated at constructor-time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size in bytes of the space to allocate for each block. </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="classFreeListChunker.html#a34497412b1e80127997593b152fa3a61">FreeListChunker&lt; NetEventNote &gt;::FreeListChunker()</a>, and <a class="el" href="classFreeListChunkerUntyped.html#ae29f2393918e07a179288584b9fbe49b">FreeListChunkerUntyped::FreeListChunkerUntyped()</a>.</p>

</div>
</div>
<a class="anchor" id="abe967e0513f83e1f5779590718d12293"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DataChunker::~DataChunker </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aa2b4ea6cb055783bf929a8c3d045b6a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* DataChunker::alloc </td>
          <td>(</td>
          <td class="paramtype">S32&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a pointer to a chunk of memory from a pre-allocated block. </p>
<p>This memory goes away when you call freeBlocks.</p>
<p>This memory is word-aligned. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of chunk to return. This must be less than chunkSize or else an assertion will occur. </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="classChunker.html#aae1df7743ea3a027ced69e01eee25f0c">Chunker&lt; ShadowVolumeBSP::SVPoly &gt;::alloc()</a>, <a class="el" href="classMultiTypedChunker.html#a0c0ea1ddd23235335ee126e5359bdf90">MultiTypedChunker::alloc()</a>, <a class="el" href="classClassChunker.html#a2b54f117398bb393016462e27f1cd624">ClassChunker&lt; SceneZoneSpace::ZoneSpaceRef &gt;::alloc()</a>, and <a class="el" href="classSceneCullingState.html#a89688f95192f87c9064152aac23a2b30">SceneCullingState::allocateData()</a>.</p>

</div>
</div>
<a class="anchor" id="a792cbcb3afef543e4cb0dfc7ac4a610f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">U32 DataChunker::countUsedBlocks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>References <a class="el" href="classDataChunker.html#a93dcfa2653fef3dbbc3ba1c1ae8a46a9">mCurBlock</a>.</p>

</div>
</div>
<a class="anchor" id="abfd50a031e61d52e3977f1d2df308dea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DataChunker::freeBlocks </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>keepOne</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free all allocated memory blocks. </p>
<p>This invalidates all pointers returned from <a class="el" href="classDataChunker.html#aa2b4ea6cb055783bf929a8c3d045b6a4" title="Return a pointer to a chunk of memory from a pre-allocated block. ">alloc()</a>. </p>

<p>Referenced by <a class="el" href="classChunker.html#ab357c09bdb4edcba9e5921c00307154a">Chunker&lt; ShadowVolumeBSP::SVPoly &gt;::clear()</a>, <a class="el" href="classMultiTypedChunker.html#aedbf7cdb861dba6d480a6764f825b835">MultiTypedChunker::clear()</a>, and <a class="el" href="classClassChunker.html#afd53eea4711c71fac2fce5b4f24e02dd">ClassChunker&lt; SceneZoneSpace::ZoneSpaceRef &gt;::freeBlocks()</a>.</p>

</div>
</div>
<a class="anchor" id="a931c15416e49f2c1a86370ff4e24eea4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataChunker::setChunkSize </td>
          <td>(</td>
          <td class="paramtype">U32&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>References <a class="el" href="classDataChunker.html#a8575b4b1460b1272f3a9d7bdcb1d9bce">mChunkSize</a>, and <a class="el" href="classDataChunker.html#a93dcfa2653fef3dbbc3ba1c1ae8a46a9">mCurBlock</a>.</p>

<p>Referenced by <a class="el" href="classHashTable.html#aa1a422d3a9c892896c90383144471436">HashTable&lt; Key, Value &gt;::resize()</a>.</p>

</div>
</div>
<a class="anchor" id="a1278ca7f4f2be89abf94c371aa706612"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataChunker::swap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDataChunker.html">DataChunker</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Swaps the memory allocated in one data chunker for another. </p>
<p>This can be used to implement packing of memory stored in a <a class="el" href="classDataChunker.html" title="Implements a chunked data allocator. ">DataChunker</a>. </p>

<p>References <a class="el" href="classDataChunker.html#a93dcfa2653fef3dbbc3ba1c1ae8a46a9">mCurBlock</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a8575b4b1460b1272f3a9d7bdcb1d9bce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">S32 DataChunker::mChunkSize</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The size allocated for each page in the <a class="el" href="classDataChunker.html" title="Implements a chunked data allocator. ">DataChunker</a>. </p>

<p>Referenced by <a class="el" href="classDataChunker.html#a931c15416e49f2c1a86370ff4e24eea4">setChunkSize()</a>.</p>

</div>
</div>
<a class="anchor" id="a93dcfa2653fef3dbbc3ba1c1ae8a46a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDataChunker_1_1DataBlock.html">DataBlock</a>* DataChunker::mCurBlock</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>current page we're allocating data from. </p>
<p>If the data size request is greater than the memory space currently available in the current page, a new page will be allocated. </p>

<p>Referenced by <a class="el" href="classDataChunker.html#a792cbcb3afef543e4cb0dfc7ac4a610f">countUsedBlocks()</a>, <a class="el" href="classDataChunker.html#a931c15416e49f2c1a86370ff4e24eea4">setChunkSize()</a>, and <a class="el" href="classDataChunker.html#a1278ca7f4f2be89abf94c371aa706612">swap()</a>.</p>

</div>
</div>
</div><!-- contents -->

<!-- START FOOTER -->
<br>
<br>
<center>
	<div style="color: #777777;">
	Copyright &copy; <a style="color: #777777;" target="_blank" href="http://www.garagegames.com">GarageGames, LLC</a>. All Rights Reserved.
	</div>
</center>
</body>
</html>
