<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Torque3D - Engine Reference: DataChunker Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Torque3D - Engine Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="class_data_chunker-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DataChunker Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="data_chunker_8h_source.html">dataChunker.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for DataChunker:</div>
<div class="dyncontent">
<div class="center"><img src="class_data_chunker__inherit__graph.png" border="0" usemap="#_data_chunker_inherit__map" alt="Inheritance graph"/></div>
<map name="_data_chunker_inherit__map" id="_data_chunker_inherit__map">
<area shape="rect" id="node2" href="class_chunker.html" title="Chunker\&lt; T \&gt;" alt="" coords="209,5,310,32"/>
<area shape="rect" id="node3" href="class_chunker.html" title="Chunker\&lt; ShadowVolumeBSP\l::SVNode \&gt;" alt="" coords="160,57,359,98"/>
<area shape="rect" id="node4" href="class_chunker.html" title="Chunker\&lt; ShadowVolumeBSP\l::SVPoly \&gt;" alt="" coords="160,122,359,163"/>
<area shape="rect" id="node5" href="class_class_chunker.html" title="ClassChunker\&lt; T \&gt;" alt="" coords="192,188,327,215"/>
<area shape="rect" id="node6" href="class_class_chunker.html" title="ClassChunker\&lt; Node \&gt;" alt="" coords="181,239,338,265"/>
<area shape="rect" id="node7" href="class_class_chunker.html" title="ClassChunker\&lt; SceneObject\l::ZoneRef \&gt;" alt="" coords="164,290,355,331"/>
<area shape="rect" id="node8" href="class_class_chunker.html" title="ClassChunker\&lt; SceneZoneSpace\l::ZoneSpaceRef \&gt;" alt="" coords="151,355,368,397"/>
<area shape="rect" id="node9" href="class_multi_typed_chunker.html" title="MultiTypedChunker" alt="" coords="193,421,326,448"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for DataChunker:</div>
<div class="dyncontent">
<div class="center"><img src="class_data_chunker__coll__graph.png" border="0" usemap="#_data_chunker_coll__map" alt="Collaboration graph"/></div>
<map name="_data_chunker_coll__map" id="_data_chunker_coll__map">
<area shape="rect" id="node2" href="struct_data_chunker_1_1_data_block.html" title="DataChunker::DataBlock" alt="" coords="5,5,171,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_data_chunker_1_1_data_block.html">DataBlock</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a4e7a7560982526271ec8cfb61bf42811"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="class_data_chunker.html#a4e7a7560982526271ec8cfb61bf42811a26c20bd412b8c1d0b7dfcb8b908793fe">PaddDBSize</a> = (sizeof(DataBlock) + 3) &amp; ~3, 
<a class="el" href="class_data_chunker.html#a4e7a7560982526271ec8cfb61bf42811a536630bb06ed00f89cfb97eadca9c7c4">ChunkSize</a> = 16384 - PaddDBSize
 }</td></tr>
<tr class="separator:a4e7a7560982526271ec8cfb61bf42811"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a73257a49053ad349f25b5b36a060c82e"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_chunker.html#a73257a49053ad349f25b5b36a060c82e">alloc</a> (S32 size)</td></tr>
<tr class="separator:a73257a49053ad349f25b5b36a060c82e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfd50a031e61d52e3977f1d2df308dea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_chunker.html#abfd50a031e61d52e3977f1d2df308dea">freeBlocks</a> (bool keepOne=false)</td></tr>
<tr class="separator:abfd50a031e61d52e3977f1d2df308dea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd20e1ef0ccc6b0727fd5a3f2f4e56f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_chunker.html#afd20e1ef0ccc6b0727fd5a3f2f4e56f8">DataChunker</a> (S32 size=<a class="el" href="class_data_chunker.html#a4e7a7560982526271ec8cfb61bf42811a536630bb06ed00f89cfb97eadca9c7c4">ChunkSize</a>)</td></tr>
<tr class="separator:afd20e1ef0ccc6b0727fd5a3f2f4e56f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1278ca7f4f2be89abf94c371aa706612"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_chunker.html#a1278ca7f4f2be89abf94c371aa706612">swap</a> (<a class="el" href="class_data_chunker.html">DataChunker</a> &amp;d)</td></tr>
<tr class="separator:a1278ca7f4f2be89abf94c371aa706612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a792cbcb3afef543e4cb0dfc7ac4a610f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a792cbcb3afef543e4cb0dfc7ac4a610f"></a>
U32&#160;</td><td class="memItemRight" valign="bottom"><b>countUsedBlocks</b> ()</td></tr>
<tr class="separator:a792cbcb3afef543e4cb0dfc7ac4a610f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a931c15416e49f2c1a86370ff4e24eea4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a931c15416e49f2c1a86370ff4e24eea4"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setChunkSize</b> (U32 size)</td></tr>
<tr class="separator:a931c15416e49f2c1a86370ff4e24eea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a93dcfa2653fef3dbbc3ba1c1ae8a46a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_data_chunker_1_1_data_block.html">DataBlock</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_chunker.html#a93dcfa2653fef3dbbc3ba1c1ae8a46a9">mCurBlock</a></td></tr>
<tr class="separator:a93dcfa2653fef3dbbc3ba1c1ae8a46a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8575b4b1460b1272f3a9d7bdcb1d9bce"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8575b4b1460b1272f3a9d7bdcb1d9bce"></a>
S32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_data_chunker.html#a8575b4b1460b1272f3a9d7bdcb1d9bce">mChunkSize</a></td></tr>
<tr class="memdesc:a8575b4b1460b1272f3a9d7bdcb1d9bce"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size allocated for each page in the <a class="el" href="class_data_chunker.html">DataChunker</a>. <br /></td></tr>
<tr class="separator:a8575b4b1460b1272f3a9d7bdcb1d9bce"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements a chunked data allocator.</p>
<p>Calling new/malloc all the time is a time consuming operation. Therefore, we provide the <a class="el" href="class_data_chunker.html">DataChunker</a>, which allocates memory in blocks of chunkSize (by default 16k, see ChunkSize, though it can be set in the constructor), then doles it out as requested, in chunks of up to chunkSize in size.</p>
<p>It will assert if you try to get more than ChunkSize bytes at a time, and it deals with the logic of allocating new blocks and giving out word-aligned chunks.</p>
<p>Note that new/free/realloc WILL NOT WORK on memory gotten from the <a class="el" href="class_data_chunker.html">DataChunker</a>. This also only grows (you can call freeBlocks to deallocate and reset things). </p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a4e7a7560982526271ec8cfb61bf42811"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a4e7a7560982526271ec8cfb61bf42811a26c20bd412b8c1d0b7dfcb8b908793fe"></a>PaddDBSize&#160;</td><td class="fielddoc">
<p>Padded size of <a class="el" href="struct_data_chunker_1_1_data_block.html">DataBlock</a>. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a4e7a7560982526271ec8cfb61bf42811a536630bb06ed00f89cfb97eadca9c7c4"></a>ChunkSize&#160;</td><td class="fielddoc">
<p>Default size of each <a class="el" href="struct_data_chunker_1_1_data_block.html">DataBlock</a> page in the <a class="el" href="class_data_chunker.html">DataChunker</a>. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="afd20e1ef0ccc6b0727fd5a3f2f4e56f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DataChunker::DataChunker </td>
          <td>(</td>
          <td class="paramtype">S32&#160;</td>
          <td class="paramname"><em>size</em> = <code><a class="el" href="class_data_chunker.html#a4e7a7560982526271ec8cfb61bf42811a536630bb06ed00f89cfb97eadca9c7c4">ChunkSize</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize using blocks of a given size.</p>
<p>One new block is allocated at constructor-time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size in bytes of the space to allocate for each block. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a73257a49053ad349f25b5b36a060c82e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * DataChunker::alloc </td>
          <td>(</td>
          <td class="paramtype">S32&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a pointer to a chunk of memory from a pre-allocated block.</p>
<p>This memory goes away when you call freeBlocks.</p>
<p>This memory is word-aligned. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of chunk to return. This must be less than chunkSize or else an assertion will occur. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abfd50a031e61d52e3977f1d2df308dea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DataChunker::freeBlocks </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>keepOne</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free all allocated memory blocks.</p>
<p>This invalidates all pointers returned from <a class="el" href="class_data_chunker.html#a73257a49053ad349f25b5b36a060c82e">alloc()</a>. </p>

</div>
</div>
<a class="anchor" id="a1278ca7f4f2be89abf94c371aa706612"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DataChunker::swap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_data_chunker.html">DataChunker</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Swaps the memory allocated in one data chunker for another. This can be used to implement packing of memory stored in a <a class="el" href="class_data_chunker.html">DataChunker</a>. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a93dcfa2653fef3dbbc3ba1c1ae8a46a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_data_chunker_1_1_data_block.html">DataBlock</a>* DataChunker::mCurBlock</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>current page we're allocating data from. If the data size request is greater than the memory space currently available in the current page, a new page will be allocated. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>C:/projects/torque3d-qw64q/Engine/source/core/<a class="el" href="data_chunker_8h_source.html">dataChunker.h</a></li>
<li>C:/projects/torque3d-qw64q/Engine/source/core/dataChunker.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
