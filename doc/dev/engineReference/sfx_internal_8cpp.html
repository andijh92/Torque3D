<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Torque3D - Engine Reference: C:/projects/torque3d-qw64q/Engine/source/sfx/sfxInternal.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Torque3D - Engine Reference
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0b6ee6e7e9547e675db4add2e5de97da.html">Engine</a></li><li class="navelem"><a class="el" href="dir_6c1eb5fc1071da5e45cf7606d68b026e.html">source</a></li><li class="navelem"><a class="el" href="dir_4898814214a975861b5aae6cf264eb86.html">sfx</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">sfxInternal.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="sfx_internal_8h_source.html">sfx/sfxInternal.h</a>&quot;</code><br />
<code>#include &quot;sfx/sfxDescription.h&quot;</code><br />
<code>#include &quot;core/util/safeDelete.h&quot;</code><br />
<code>#include &quot;<a class="el" href="thread_pool_async_i_o_8h_source.html">platform/threads/threadPoolAsyncIO.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for sfxInternal.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="sfx_internal_8cpp__incl.png" border="0" usemap="#_c_1_2projects_2torque3d-qw64q_2_engine_2source_2sfx_2sfx_internal_8cpp" alt=""/></div>
<map name="_c_1_2projects_2torque3d-qw64q_2_engine_2source_2sfx_2sfx_internal_8cpp" id="_c_1_2projects_2torque3d-qw64q_2_engine_2source_2sfx_2sfx_internal_8cpp">
<area shape="rect" id="node2" href="sfx_internal_8h.html" title="sfx/sfxInternal.h" alt="" coords="1041,109,1155,136"/>
<area shape="rect" id="node11" href="safe_delete_8h_source.html" title="core/util/safeDelete.h" alt="" coords="2230,840,2374,867"/>
<area shape="rect" id="node24" href="thread_pool_async_i_o_8h.html" title="platform/threads/threadPool\lAsyncIO.h" alt="" coords="389,348,570,389"/>
<area shape="rect" id="node43" href="sfx_description_8h_source.html" title="sfx/sfxDescription.h" alt="" coords="1939,184,2075,211"/>
<area shape="rect" id="node3" href="thread_pool_8h.html" title="platform/threads/threadPool.h" alt="" coords="401,437,593,464"/>
<area shape="rect" id="node16" href="t_singleton_8h_source.html" title="core/util/tSingleton.h" alt="" coords="1186,609,1327,635"/>
<area shape="rect" id="node17" href="async_update_8h_source.html" title="platform/async/asyncUpdate.h" alt="" coords="844,437,1043,464"/>
<area shape="rect" id="node20" href="async_packet_stream_8h.html" title="platform/async/asyncPacket\lStream.h" alt="" coords="386,259,573,300"/>
<area shape="rect" id="node25" href="async_packet_queue_8h.html" title="platform/async/asyncPacket\lQueue.h" alt="" coords="85,348,271,389"/>
<area shape="rect" id="node27" href="sfx_stream_8h_source.html" title="sfx/sfxStream.h" alt="" coords="916,266,1029,293"/>
<area shape="rect" id="node35" href="console_8h_source.html" title="console/console.h" alt="" coords="1547,519,1673,546"/>
<area shape="rect" id="node41" href="sfx_buffer_8h_source.html" title="sfx/sfxBuffer.h" alt="" coords="1286,266,1390,293"/>
<area shape="rect" id="node42" href="sfx_voice_8h_source.html" title="sfx/sfxVoice.h" alt="" coords="1341,184,1445,211"/>
<area shape="rect" id="node4" href="thread_safe_ref_count_8h.html" title="platform/threads/threadSafe\lRefCount.h" alt="" coords="829,601,1010,643"/>
<area shape="rect" id="node12" href="thread_safe_priority_queue_8h.html" title="platform/threads/threadSafe\lPriorityQueue.h" alt="" coords="469,512,650,553"/>
<area shape="rect" id="node15" href="semaphore_8h_source.html" title="platform/threads/semaphore.h" alt="" coords="378,765,573,792"/>
<area shape="rect" id="node5" href="platform_intrinsics_8h_source.html" title="platform/platformIntrinsics.h" alt="" coords="767,691,949,717"/>
<area shape="rect" id="node7" href="typetraits_8h.html" title="platform/typetraits.h" alt="" coords="973,691,1111,717"/>
<area shape="rect" id="node6" href="types_8h_source.html" title="platform/types.h" alt="" coords="1091,915,1206,941"/>
<area shape="rect" id="node8" href="platform_8h_source.html" title="platform/platform.h" alt="" coords="1231,765,1360,792"/>
<area shape="rect" id="node9" href="platform_assert_8h_source.html" title="platform/platformAssert.h" alt="" coords="1644,840,1811,867"/>
<area shape="rect" id="node10" href="str_8h_source.html" title="core/util/str.h" alt="" coords="1246,840,1345,867"/>
<area shape="rect" id="node13" href="tmm__off_8h_source.html" title="platform/tmm_off.h" alt="" coords="520,609,649,635"/>
<area shape="rect" id="node14" href="tmm__on_8h_source.html" title="platform/tmm_on.h" alt="" coords="674,609,805,635"/>
<area shape="rect" id="node18" href="thread_8h_source.html" title="platform/threads/thread.h" alt="" coords="1235,519,1401,546"/>
<area shape="rect" id="node19" href="thread_safe_deque_8h_source.html" title="platform/threads/threadSafe\lDeque.h" alt="" coords="725,512,906,553"/>
<area shape="rect" id="node21" href="async_buffered_stream_8h_source.html" title="platform/async/asyncBuffered\lStream.h" alt="" coords="647,348,840,389"/>
<area shape="rect" id="node23" href="raw_data_8h_source.html" title="core/util/rawData.h" alt="" coords="263,519,394,546"/>
<area shape="rect" id="node22" href="t_stream_8h.html" title="core/stream/tStream.h" alt="" coords="667,437,819,464"/>
<area shape="rect" id="node26" href="t_fixed_size_deque_8h_source.html" title="core/util/tFixedSizeDeque.h" alt="" coords="5,691,188,717"/>
<area shape="rect" id="node28" href="sfx_common_8h_source.html" title="sfx/sfxCommon.h" alt="" coords="1429,355,1551,382"/>
<area shape="rect" id="node29" href="m_math_fn_8h_source.html" title="math/mMathFn.h" alt="" coords="2093,609,2215,635"/>
<area shape="rect" id="node30" href="m_random_8h_source.html" title="math/mRandom.h" alt="" coords="1887,765,2013,792"/>
<area shape="rect" id="node31" href="m_matrix_8h_source.html" title="math/mMatrix.h" alt="" coords="1579,437,1692,464"/>
<area shape="rect" id="node32" href="m_point3_8h_source.html" title="math/mPoint3.h" alt="" coords="2010,437,2125,464"/>
<area shape="rect" id="node34" href="dynamic_types_8h.html" title="console/dynamicTypes.h" alt="" coords="1819,437,1985,464"/>
<area shape="rect" id="node33" href="m_point2_8h_source.html" title="math/mPoint2.h" alt="" coords="2102,519,2217,546"/>
<area shape="rect" id="node36" href="bit_set_8h_source.html" title="core/bitSet.h" alt="" coords="1333,691,1429,717"/>
<area shape="rect" id="node37" href="ref_base_8h_source.html" title="core/util/refBase.h" alt="" coords="1840,609,1967,635"/>
<area shape="rect" id="node39" href="journaled_signal_8h_source.html" title="core/util/journal/journaled\lSignal.h" alt="" coords="1555,601,1721,643"/>
<area shape="rect" id="node40" href="t_signal_8h_source.html" title="core/util/tSignal.h" alt="" coords="1866,691,1989,717"/>
<area shape="rect" id="node44" href="console_types_8h.html" title="console/consoleTypes.h" alt="" coords="2022,266,2185,293"/>
<area shape="rect" id="node48" href="sim_datablock_8h_source.html" title="console/simDatablock.h" alt="" coords="1829,266,1991,293"/>
<area shape="rect" id="node50" href="m_ease_8h_source.html" title="math/mEase.h" alt="" coords="2513,266,2619,293"/>
<area shape="rect" id="node45" href="math_types_8h_source.html" title="math/mathTypes.h" alt="" coords="1935,355,2066,382"/>
<area shape="rect" id="node46" href="engine_primitives_8h.html" title="console/enginePrimitives.h" alt="" coords="2141,355,2317,382"/>
<area shape="rect" id="node47" href="engine_structs_8h.html" title="console/engineStructs.h" alt="" coords="2341,355,2503,382"/>
<area shape="rect" id="node49" href="sim_base_8h_source.html" title="console/simBase.h" alt="" coords="1778,355,1911,382"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad0fbcb2151db9cebebc01072d6fe9f85"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_thread_safe_ref.html">ThreadSafeRef</a>&lt; SFXUpdateThread &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sfx_internal_8cpp.html#ad0fbcb2151db9cebebc01072d6fe9f85">SFXInternal::gUpdateThread</a></td></tr>
<tr class="separator:ad0fbcb2151db9cebebc01072d6fe9f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25eb337ce5d682f45a0f566d06697ce6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_thread_safe_ref.html">ThreadSafeRef</a>&lt; SFXBufferProcessList &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sfx_internal_8cpp.html#a25eb337ce5d682f45a0f566d06697ce6">SFXInternal::gBufferUpdateList</a> = new SFXBufferProcessList</td></tr>
<tr class="separator:a25eb337ce5d682f45a0f566d06697ce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b05974f9468baffbcfb4c78fc808699"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_thread_safe_deque.html">ThreadSafeDeque</a>&lt; <a class="el" href="class_s_f_x_buffer.html">SFXBuffer</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sfx_internal_8cpp.html#a7b05974f9468baffbcfb4c78fc808699">SFXInternal::gDeadBufferList</a></td></tr>
<tr class="separator:a7b05974f9468baffbcfb4c78fc808699"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of async sound I/O. </p>
</div><h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="file_a25eb337ce5d682f45a0f566d06697ce6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_thread_safe_ref.html">ThreadSafeRef</a>&lt; SFXBufferProcessList &gt; SFXInternal::gBufferUpdateList = new SFXBufferProcessList</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>List of buffers that need updating.</p>
<p>It depends on the actual device whether this list is processed on a stream update thread or on the main thread. </p>

</div>
</div>
<a class="anchor" id="file_a7b05974f9468baffbcfb4c78fc808699"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_thread_safe_deque.html">ThreadSafeDeque</a>&lt; <a class="el" href="class_s_f_x_buffer.html">SFXBuffer</a> * &gt; SFXInternal::gDeadBufferList</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>List of buffers that are pending deletion.</p>
<p>This is a messy issue. Buffers with live async states cannot be instantly deleted since they may still be running concurrent updates. However, they also cannot be deleted on the update thread since the <a class="el" href="class_strong_ref_base.html">StrongRefBase</a> stuff isn't thread-safe (i.e weak references kept by client code would cause trouble).</p>
<p>So, what we do is mark buffers for deletion, wait till they surface on the process list and then ping them back to this list to have them deleted by the <a class="el" href="class_s_f_x_device.html" title="Abstract base class for back-end sound API implementations. ">SFXDevice</a> itself on the main thread. A bit of overhead but only a fraction of the buffers will ever undergo this procedure. </p>

</div>
</div>
<a class="anchor" id="file_ad0fbcb2151db9cebebc01072d6fe9f85"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_thread_safe_ref.html">ThreadSafeRef</a>&lt; <a class="el" href="class_async_update_thread.html">AsyncUpdateThread</a> &gt; SFXInternal::gUpdateThread</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Dedicated thread that does sound buffer updates. May be NULL if sound API used does not do asynchronous buffer updates but rather uses per-frame polling.</p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="class_s_f_x_device.html" title="Abstract base class for back-end sound API implementations. ">SFXDevice</a> automatically polls if this is NULL. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
